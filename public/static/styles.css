/* ============================================================
   Neomemoria - Premium UI System v6.0
   - Sharp right-to-left blade flash effect (gleaming-pearl & cyber-neon only)
   - 9 premium themes with overwhelming visual quality
   - Dull Black: muted, eye-friendly dark tones
   - Gleaming Black Pearl: iridescent pearl sheen + flash
   - Dark Forest: bonfire warmth with ember particles
   - White Pearl: luminous pearl elegance + shimmer
   - Dreamy: soft pastel wonderland, floating feel
   - Midnight Ocean: deep sea bioluminescence
   - Sakura: Japanese petal aesthetic, warm tones
   - Aurora Borealis: northern lights dancing
   - Cyber Neon: electric cyberpunk + flash
   - 3 button layout options
   - Enlarged rating buttons
   - Performance optimized
   ============================================================ */

:root {
  --font-main: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Hiragino Kaku Gothic ProN', 'Noto Sans JP', sans-serif;
  --radius-sm: 8px;
  --radius-md: 12px;
  --radius-lg: 16px;
  --radius-xl: 22px;
  --shadow-sm: 0 2px 8px rgba(0,0,0,0.08);
  --shadow-md: 0 4px 20px rgba(0,0,0,0.12);
  --shadow-lg: 0 8px 40px rgba(0,0,0,0.18);
  --transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  --transition-fast: all 0.12s ease;
}

/* ================================================================
   THEME 1: DULL BLACK
   Concept: Muted, subdued colors for a calm, dark environment.
   Easy on the eyes. Everything is softened and desaturated.
   ================================================================ */
[data-theme="dull-black"] {
  --bg-primary: #1a1a1e;
  --bg-secondary: #222226;
  --bg-tertiary: #2a2a2f;
  --bg-card: #26262b;
  --bg-card-hover: #303036;
  --bg-input: #1e1e23;
  --bg-overlay: rgba(10,10,12,0.88);
  --text-primary: #b8b8c0;
  --text-secondary: #808088;
  --text-tertiary: #58585f;
  --text-accent: #9494a8;
  --border: #38383e;
  --border-light: #2e2e34;
  --accent: #7a7a9a;
  --accent-hover: #8a8aaa;
  --accent-glow: rgba(122,122,154,0.12);
  --success: #5a8a5a;
  --success-bg: rgba(90,138,90,0.12);
  --warning: #9a8a4a;
  --warning-bg: rgba(154,138,74,0.12);
  --danger: #9a5a5a;
  --danger-bg: rgba(154,90,90,0.12);
  --info: #5a7a9a;
  --info-bg: rgba(90,122,154,0.12);
  --card-front: linear-gradient(145deg, #28282d, #232327);
  --card-back: linear-gradient(145deg, #2c2c32, #272730);
  --menu-bg: #202024;
  --badge-bg: #333338;
  --scrollbar-track: #1a1a1e;
  --scrollbar-thumb: #3a3a40;
}

/* ================================================================
   THEME 2: GLEAMING BLACK PEARL
   Concept: Lustrous black pearl surface with iridescent sheen.
   Deep blacks with violet/blue/indigo pearl reflections.
   Accented with the blade-flash shimmer effect.
   ================================================================ */
[data-theme="gleaming-pearl"] {
  --bg-primary: #09090f;
  --bg-secondary: #101018;
  --bg-tertiary: #181822;
  --bg-card: #131320;
  --bg-card-hover: #1a1a2c;
  --bg-input: #0c0c14;
  --bg-overlay: rgba(4,4,8,0.92);
  --text-primary: #d4d4e8;
  --text-secondary: #8888a8;
  --text-tertiary: #505070;
  --text-accent: #b0a0e0;
  --border: #28283c;
  --border-light: #1c1c30;
  --accent: #7868e0;
  --accent-hover: #8878f0;
  --accent-glow: rgba(120,104,224,0.18);
  --success: #4ae88a;
  --success-bg: rgba(74,232,138,0.08);
  --warning: #e8c84a;
  --warning-bg: rgba(232,200,74,0.08);
  --danger: #e84a6a;
  --danger-bg: rgba(232,74,106,0.08);
  --info: #4aa8e8;
  --info-bg: rgba(74,168,232,0.08);
  --card-front: linear-gradient(145deg, #131320, #0f0f1a);
  --card-back: linear-gradient(145deg, #181828, #131320);
  --menu-bg: #0c0c16;
  --badge-bg: #222236;
  --scrollbar-track: #09090f;
  --scrollbar-thumb: #28283c;
}

/* ================================================================
   THEME 3: DARK FOREST BONFIRE
   Concept: Deep in a dark forest at night, illuminated only
   by a crackling bonfire. Warm ember tones against deep greens.
   Firefly particles drift through the scene.
   ================================================================ */
[data-theme="dark-forest"] {
  --bg-primary: #0c110c;
  --bg-secondary: #131a12;
  --bg-tertiary: #1a2218;
  --bg-card: #162016;
  --bg-card-hover: #1e2a1e;
  --bg-input: #0f1610;
  --bg-overlay: rgba(6,10,6,0.92);
  --text-primary: #d4cbb4;
  --text-secondary: #8a8670;
  --text-tertiary: #5a5644;
  --text-accent: #e8a040;
  --border: #283024;
  --border-light: #1e261a;
  --accent: #e88630;
  --accent-hover: #f09840;
  --accent-glow: rgba(232,134,48,0.16);
  --success: #5aaa4a;
  --success-bg: rgba(90,170,74,0.1);
  --warning: #d4a030;
  --warning-bg: rgba(212,160,48,0.1);
  --danger: #c84a3a;
  --danger-bg: rgba(200,74,58,0.1);
  --info: #4a8ab0;
  --info-bg: rgba(74,138,176,0.1);
  --card-front: linear-gradient(145deg, #162016, #121a12);
  --card-back: linear-gradient(145deg, #1a2418, #162016);
  --menu-bg: #101810;
  --badge-bg: #243020;
  --scrollbar-track: #0c110c;
  --scrollbar-thumb: #283024;
  --ember: #e87830;
  --fire-core: #ff9030;
  --fire-glow: radial-gradient(ellipse at 50% 100%, rgba(232,120,48,0.1) 0%, rgba(200,80,20,0.04) 40%, transparent 70%);
}

/* ================================================================
   THEME 4: WHITE PEARL
   Concept: A pristine white pearl radiating soft light.
   Clean, luminous, with subtle iridescent shimmer accents.
   Elegant and refined - like holding a perfect pearl.
   ================================================================ */
[data-theme="white-pearl"] {
  --bg-primary: #f4f2ee;
  --bg-secondary: #fefefe;
  --bg-tertiary: #ece9e4;
  --bg-card: #ffffff;
  --bg-card-hover: #faf8f4;
  --bg-input: #f7f5f1;
  --bg-overlay: rgba(244,242,238,0.94);
  --text-primary: #2a2826;
  --text-secondary: #6a6864;
  --text-tertiary: #9a9894;
  --text-accent: #5a4a8a;
  --border: #dedad4;
  --border-light: #e8e6e0;
  --accent: #7a5aaa;
  --accent-hover: #8a6aba;
  --accent-glow: rgba(122,90,170,0.1);
  --success: #3a8a4a;
  --success-bg: rgba(58,138,74,0.08);
  --warning: #aa7a2a;
  --warning-bg: rgba(170,122,42,0.08);
  --danger: #c04040;
  --danger-bg: rgba(192,64,64,0.08);
  --info: #3a6aaa;
  --info-bg: rgba(58,106,170,0.08);
  --card-front: linear-gradient(145deg, #ffffff, #faf8f4);
  --card-back: linear-gradient(145deg, #fdfcfa, #f8f5f0);
  --menu-bg: #fefefe;
  --badge-bg: #eeebe6;
  --scrollbar-track: #f4f2ee;
  --scrollbar-thumb: #ccc8c2;
}

/* ================================================================
   THEME 5: DREAMY
   Concept: Floating in a dream. Soft pastels, cotton candy clouds,
   magical sparkles. Cute, warm, and whimsical.
   ================================================================ */
[data-theme="dreamy"] {
  --bg-primary: #fceff4;
  --bg-secondary: #fff4f8;
  --bg-tertiary: #f4e6ee;
  --bg-card: #fff7fa;
  --bg-card-hover: #ffeff5;
  --bg-input: #fdf1f6;
  --bg-overlay: rgba(252,239,244,0.94);
  --text-primary: #4a2840;
  --text-secondary: #886878;
  --text-tertiary: #b098a8;
  --text-accent: #c06898;
  --border: #eed6e4;
  --border-light: #f4dde8;
  --accent: #e07aaa;
  --accent-hover: #e88aba;
  --accent-glow: rgba(224,122,170,0.12);
  --success: #58aa78;
  --success-bg: rgba(88,170,120,0.1);
  --warning: #d4a060;
  --warning-bg: rgba(212,160,96,0.1);
  --danger: #d06070;
  --danger-bg: rgba(208,96,112,0.1);
  --info: #6098c8;
  --info-bg: rgba(96,152,200,0.1);
  --card-front: linear-gradient(145deg, #fff7fa, #fef3f7);
  --card-back: linear-gradient(145deg, #fff5f9, #fceff5);
  --menu-bg: #fff4f8;
  --badge-bg: #f6e2ee;
  --scrollbar-track: #fceff4;
  --scrollbar-thumb: #e4c4d6;
}

/* ================================================================
   THEME 6: MIDNIGHT OCEAN
   Concept: Deep ocean at midnight. Bioluminescent creatures
   create soft blue glows in the abyss. Calm and mysterious.
   ================================================================ */
[data-theme="midnight-ocean"] {
  --bg-primary: #080c18;
  --bg-secondary: #0e1428;
  --bg-tertiary: #141e34;
  --bg-card: #101a2e;
  --bg-card-hover: #182440;
  --bg-input: #0a1020;
  --bg-overlay: rgba(4,6,14,0.93);
  --text-primary: #c4d0e8;
  --text-secondary: #6880a8;
  --text-tertiary: #3a4868;
  --text-accent: #80b0f0;
  --border: #1c2848;
  --border-light: #142038;
  --accent: #4488ee;
  --accent-hover: #5598ff;
  --accent-glow: rgba(68,136,238,0.15);
  --success: #44cc88;
  --success-bg: rgba(68,204,136,0.08);
  --warning: #eeaa44;
  --warning-bg: rgba(238,170,68,0.08);
  --danger: #ee4466;
  --danger-bg: rgba(238,68,102,0.08);
  --info: #44aaee;
  --info-bg: rgba(68,170,238,0.08);
  --card-front: linear-gradient(145deg, #101a2e, #0e1428);
  --card-back: linear-gradient(145deg, #141e34, #101a2e);
  --menu-bg: #0c1224;
  --badge-bg: #1a2240;
  --scrollbar-track: #080c18;
  --scrollbar-thumb: #1c2848;
}

/* ================================================================
   THEME 7: SAKURA
   Concept: Cherry blossom season in Japan. Warm petal pinks,
   soft peach, traditional Japanese aesthetic. Serene.
   ================================================================ */
[data-theme="sakura"] {
  --bg-primary: #fdf5ef;
  --bg-secondary: #fff8f4;
  --bg-tertiary: #f6ece2;
  --bg-card: #fffaf6;
  --bg-card-hover: #fff3ec;
  --bg-input: #fdf3eb;
  --bg-overlay: rgba(253,245,239,0.94);
  --text-primary: #4a3028;
  --text-secondary: #8a6858;
  --text-tertiary: #b8a090;
  --text-accent: #d4705a;
  --border: #eedad0;
  --border-light: #f4e2d6;
  --accent: #e8705a;
  --accent-hover: #f0806a;
  --accent-glow: rgba(232,112,90,0.12);
  --success: #5aaa6a;
  --success-bg: rgba(90,170,106,0.08);
  --warning: #d4a050;
  --warning-bg: rgba(212,160,80,0.08);
  --danger: #d05050;
  --danger-bg: rgba(208,80,80,0.08);
  --info: #5a90c8;
  --info-bg: rgba(90,144,200,0.08);
  --card-front: linear-gradient(145deg, #fffaf6, #fdf5ee);
  --card-back: linear-gradient(145deg, #fff8f3, #fcf2ea);
  --menu-bg: #fff8f4;
  --badge-bg: #f6e6d6;
  --scrollbar-track: #fdf5ef;
  --scrollbar-thumb: #e4c8b4;
}

/* ================================================================
   THEME 8: AURORA BOREALIS
   Concept: Standing under the northern lights. Greens, teals,
   purples, and blues dance across a deep polar sky.
   ================================================================ */
[data-theme="aurora"] {
  --bg-primary: #060a14;
  --bg-secondary: #0c1224;
  --bg-tertiary: #121c34;
  --bg-card: #0e1830;
  --bg-card-hover: #142040;
  --bg-input: #081020;
  --bg-overlay: rgba(3,5,12,0.93);
  --text-primary: #cce8e4;
  --text-secondary: #608894;
  --text-tertiary: #385068;
  --text-accent: #60e8b0;
  --border: #182840;
  --border-light: #102030;
  --accent: #40d8a0;
  --accent-hover: #50e8b0;
  --accent-glow: rgba(64,216,160,0.14);
  --success: #40d890;
  --success-bg: rgba(64,216,144,0.08);
  --warning: #e8c040;
  --warning-bg: rgba(232,192,64,0.08);
  --danger: #e85070;
  --danger-bg: rgba(232,80,112,0.08);
  --info: #50a0e8;
  --info-bg: rgba(80,160,232,0.08);
  --card-front: linear-gradient(145deg, #0e1830, #0c1224);
  --card-back: linear-gradient(145deg, #121c34, #0e1830);
  --menu-bg: #0a1020;
  --badge-bg: #182840;
  --scrollbar-track: #060a14;
  --scrollbar-thumb: #182840;
}

/* ================================================================
   THEME 9: CYBER NEON
   Concept: Cyberpunk city at night. Electric magenta, cyan,
   and purple neon signs. Digital, sharp, high-tech.
   ================================================================ */
[data-theme="cyber-neon"] {
  --bg-primary: #08081a;
  --bg-secondary: #10101e;
  --bg-tertiary: #181828;
  --bg-card: #121222;
  --bg-card-hover: #1a1a30;
  --bg-input: #0c0c16;
  --bg-overlay: rgba(4,4,12,0.93);
  --text-primary: #e0e0f0;
  --text-secondary: #8080b0;
  --text-tertiary: #4a4a70;
  --text-accent: #ff60e0;
  --border: #282840;
  --border-light: #1c1c30;
  --accent: #e040c0;
  --accent-hover: #f050d0;
  --accent-glow: rgba(224,64,192,0.16);
  --success: #40e888;
  --success-bg: rgba(64,232,136,0.08);
  --warning: #e8d040;
  --warning-bg: rgba(232,208,64,0.08);
  --danger: #ff4060;
  --danger-bg: rgba(255,64,96,0.08);
  --info: #40c0ff;
  --info-bg: rgba(64,192,255,0.08);
  --card-front: linear-gradient(145deg, #121222, #10101e);
  --card-back: linear-gradient(145deg, #181828, #121222);
  --menu-bg: #0e0e1c;
  --badge-bg: #222238;
  --scrollbar-track: #08081a;
  --scrollbar-thumb: #282840;
}

/* ===== Global Reset ===== */
*,*::before,*::after { box-sizing:border-box; margin:0; padding:0; }
html { font-size:16px; -webkit-text-size-adjust:100%; -webkit-tap-highlight-color:transparent; }
body {
  font-family: var(--font-main);
  background: var(--bg-primary);
  color: var(--text-primary);
  line-height: 1.5;
  min-height: 100vh;
  min-height: 100dvh;
  overflow-x: hidden;
  -webkit-font-smoothing: antialiased;
}

::-webkit-scrollbar { width:5px; }
::-webkit-scrollbar-track { background:var(--scrollbar-track); }
::-webkit-scrollbar-thumb { background:var(--scrollbar-thumb); border-radius:3px; }

/* ================================================================
   THEME ATMOSPHERIC BACKGROUNDS - Immersive ambient layers
   ================================================================ */

/* Dull Black: ultra-subtle noise texture feel */
[data-theme="dull-black"] body::before {
  content:''; position:fixed; inset:0;
  background: radial-gradient(ellipse at 50% 0%, rgba(122,122,154,0.02) 0%, transparent 60%);
  pointer-events:none; z-index:0;
}

/* Gleaming Pearl: iridescent pearl sheen overlay */
[data-theme="gleaming-pearl"] body::before {
  content:''; position:fixed; inset:0;
  background:
    radial-gradient(ellipse at 25% 15%, rgba(120,100,240,0.06) 0%, transparent 45%),
    radial-gradient(ellipse at 75% 85%, rgba(80,140,255,0.04) 0%, transparent 45%),
    radial-gradient(ellipse at 50% 50%, rgba(160,100,220,0.03) 0%, transparent 50%);
  pointer-events:none; z-index:0;
  animation: pearlAmbience 10s ease-in-out infinite alternate;
}
@keyframes pearlAmbience {
  0% { opacity:0.7; }
  50% { opacity:1; }
  100% { opacity:0.6; }
}

/* Dark Forest: firefly particles + bottom fire glow */
[data-theme="dark-forest"] body::before {
  content:''; position:fixed; inset:0;
  background:
    radial-gradient(2px 2px at 15% 25%, rgba(255,210,60,0.35), transparent),
    radial-gradient(1.5px 1.5px at 78% 18%, rgba(255,200,50,0.25), transparent),
    radial-gradient(1px 1px at 45% 68%, rgba(255,180,40,0.2), transparent),
    radial-gradient(1.5px 1.5px at 88% 72%, rgba(255,200,60,0.3), transparent),
    radial-gradient(1px 1px at 32% 88%, rgba(255,190,50,0.2), transparent),
    radial-gradient(1.5px 1.5px at 62% 42%, rgba(255,220,70,0.15), transparent);
  pointer-events:none; z-index:0;
  animation: fireflyDrift 14s ease-in-out infinite alternate;
}
@keyframes fireflyDrift {
  0% { opacity:0.5; transform:translate3d(0,0,0); }
  25% { opacity:0.9; transform:translate3d(4px,-3px,0); }
  50% { opacity:0.4; transform:translate3d(-3px,4px,0); }
  75% { opacity:0.8; transform:translate3d(2px,-1px,0); }
  100% { opacity:0.6; transform:translate3d(-1px,2px,0); }
}
[data-theme="dark-forest"] body::after {
  content:''; position:fixed; bottom:0; left:0; right:0; height:45vh;
  background:
    radial-gradient(ellipse at 50% 100%, rgba(232,120,48,0.1) 0%, transparent 60%),
    radial-gradient(ellipse at 40% 100%, rgba(200,80,20,0.06) 0%, transparent 50%),
    radial-gradient(ellipse at 60% 100%, rgba(255,150,50,0.04) 0%, transparent 50%);
  pointer-events:none; z-index:0;
  animation: fireFlicker 4s ease-in-out infinite alternate;
}
@keyframes fireFlicker {
  0% { opacity:0.7; }
  30% { opacity:1; }
  60% { opacity:0.8; }
  100% { opacity:0.9; }
}

/* White Pearl: subtle prismatic shimmer */
[data-theme="white-pearl"] body::before {
  content:''; position:fixed; inset:0;
  background:
    radial-gradient(ellipse at 20% 10%, rgba(180,140,220,0.06) 0%, transparent 45%),
    radial-gradient(ellipse at 80% 90%, rgba(140,180,220,0.05) 0%, transparent 45%),
    radial-gradient(ellipse at 50% 30%, rgba(200,160,200,0.04) 0%, transparent 40%);
  pointer-events:none; z-index:0;
}

/* Dreamy: floating pastel cloud glow */
[data-theme="dreamy"] body::before {
  content:''; position:fixed; inset:0;
  background:
    radial-gradient(ellipse at 30% 10%, rgba(224,122,170,0.06) 0%, transparent 40%),
    radial-gradient(ellipse at 70% 90%, rgba(200,160,240,0.05) 0%, transparent 40%),
    radial-gradient(ellipse at 50% 50%, rgba(240,180,210,0.03) 0%, transparent 50%);
  pointer-events:none; z-index:0;
  animation: dreamFloat 12s ease-in-out infinite alternate;
}
@keyframes dreamFloat {
  0% { opacity:0.6; transform:translate3d(0,0,0); }
  50% { opacity:1; transform:translate3d(0,-3px,0); }
  100% { opacity:0.7; transform:translate3d(0,2px,0); }
}

/* Midnight Ocean: deep sea bioluminescent glow */
[data-theme="midnight-ocean"] body::before {
  content:''; position:fixed; inset:0;
  background:
    radial-gradient(ellipse at 25% 20%, rgba(68,136,238,0.05) 0%, transparent 45%),
    radial-gradient(ellipse at 75% 80%, rgba(40,100,200,0.04) 0%, transparent 45%),
    radial-gradient(ellipse at 50% 60%, rgba(68,170,238,0.02) 0%, transparent 50%);
  pointer-events:none; z-index:0;
  animation: oceanPulse 8s ease-in-out infinite alternate;
}
@keyframes oceanPulse {
  0% { opacity:0.5; }
  50% { opacity:1; }
  100% { opacity:0.6; }
}

/* Sakura: falling petal ambient warmth */
[data-theme="sakura"] body::before {
  content:''; position:fixed; inset:0;
  background:
    radial-gradient(ellipse at 20% 10%, rgba(232,112,90,0.05) 0%, transparent 45%),
    radial-gradient(ellipse at 80% 85%, rgba(240,140,120,0.04) 0%, transparent 45%),
    radial-gradient(ellipse at 50% 40%, rgba(255,180,160,0.03) 0%, transparent 40%);
  pointer-events:none; z-index:0;
}

/* Aurora: multi-color curtains */
[data-theme="aurora"] body::before {
  content:''; position:fixed; inset:0;
  background:
    radial-gradient(ellipse at 15% 0%, rgba(64,216,160,0.07) 0%, transparent 35%),
    radial-gradient(ellipse at 50% 5%, rgba(80,120,232,0.06) 0%, transparent 35%),
    radial-gradient(ellipse at 85% 0%, rgba(160,80,232,0.05) 0%, transparent 30%),
    radial-gradient(ellipse at 35% 10%, rgba(100,200,180,0.04) 0%, transparent 35%);
  pointer-events:none; z-index:0;
  animation: auroraPulse 10s ease-in-out infinite alternate;
}
@keyframes auroraPulse {
  0% { opacity:0.5; }
  33% { opacity:0.9; }
  66% { opacity:0.6; }
  100% { opacity:0.8; }
}

/* Cyber Neon: ambient neon glow */
[data-theme="cyber-neon"] body::before {
  content:''; position:fixed; inset:0;
  background:
    radial-gradient(ellipse at 20% 80%, rgba(224,64,192,0.05) 0%, transparent 40%),
    radial-gradient(ellipse at 80% 20%, rgba(64,192,255,0.04) 0%, transparent 40%),
    radial-gradient(ellipse at 50% 50%, rgba(160,40,200,0.02) 0%, transparent 40%);
  pointer-events:none; z-index:0;
}

/* ================================================================
   THEME-SPECIFIC FLASHCARD & CARD EFFECTS
   ================================================================ */

/* Gleaming Pearl: iridescent card border + sheen */
[data-theme="gleaming-pearl"] .flashcard-face {
  box-shadow:
    0 0 40px rgba(120,104,224,0.06),
    0 0 80px rgba(100,80,200,0.03),
    inset 0 1px 0 rgba(255,255,255,0.05);
}
[data-theme="gleaming-pearl"] .flashcard::after {
  content:''; position:absolute; inset:-1px; border-radius:var(--radius-xl);
  background: linear-gradient(135deg,
    rgba(120,100,255,0.08) 0%, transparent 30%,
    rgba(180,120,255,0.06) 50%, transparent 70%,
    rgba(100,160,255,0.08) 100%);
  pointer-events:none; z-index:1;
  animation: pearlSheen 6s ease-in-out infinite;
}
@keyframes pearlSheen { 0%,100% { opacity:0.3; } 50% { opacity:0.8; } }

/* Dark Forest: warm firelight on cards */
[data-theme="dark-forest"] .flashcard-face {
  box-shadow:
    0 8px 30px rgba(0,0,0,0.3),
    0 0 60px rgba(232,120,48,0.05),
    inset 0 -1px 0 rgba(232,134,42,0.04);
}

/* White Pearl: soft pearl glow on cards */
[data-theme="white-pearl"] .flashcard-face {
  box-shadow: 0 4px 30px rgba(0,0,0,0.05), 0 0 20px rgba(122,90,170,0.04);
}
[data-theme="white-pearl"] .flashcard::after {
  content:''; position:absolute; inset:-1px; border-radius:var(--radius-xl);
  background: linear-gradient(135deg,
    rgba(180,140,220,0.06), transparent 40%,
    rgba(140,180,220,0.04), transparent 70%,
    rgba(200,160,200,0.06));
  pointer-events:none; z-index:1;
  animation: whitePearlSheen 7s ease-in-out infinite;
}
@keyframes whitePearlSheen { 0%,100% { opacity:0.3; } 50% { opacity:0.7; } }

/* Dreamy: soft pastel glow on cards */
[data-theme="dreamy"] .flashcard-face {
  box-shadow: 0 4px 30px rgba(200,100,150,0.08);
}
[data-theme="dreamy"] .flashcard::after {
  content:''; position:absolute; inset:-1px; border-radius:var(--radius-xl);
  background: linear-gradient(135deg, rgba(224,122,170,0.06), transparent 50%, rgba(200,160,240,0.05));
  pointer-events:none; z-index:1;
}
[data-theme="dreamy"] .flashcard-front,
[data-theme="dreamy"] .flashcard-back {
  background: linear-gradient(145deg, #fff8fb, #fef2f7, #fff5f9);
}

/* Midnight Ocean: deep bioluminescence */
[data-theme="midnight-ocean"] .flashcard-face {
  box-shadow: 0 4px 40px rgba(68,136,238,0.07), inset 0 1px 0 rgba(255,255,255,0.02);
}

/* Sakura: warm petal tones */
[data-theme="sakura"] .flashcard-face {
  box-shadow: 0 4px 30px rgba(232,112,90,0.06);
}
[data-theme="sakura"] .flashcard-front,
[data-theme="sakura"] .flashcard-back {
  background: linear-gradient(145deg, #fffaf6, #fef4ee, #fff8f3);
}

/* Aurora: northern lights glow on cards */
[data-theme="aurora"] .flashcard-face {
  box-shadow: 0 0 40px rgba(64,216,160,0.06), 0 0 80px rgba(80,120,232,0.03);
}
[data-theme="aurora"] .flashcard::after {
  content:''; position:absolute; inset:-1px; border-radius:var(--radius-xl);
  background: linear-gradient(135deg, rgba(64,216,160,0.05), transparent 40%, rgba(80,120,232,0.04));
  pointer-events:none; z-index:1;
}

/* Cyber Neon: neon glow on cards */
[data-theme="cyber-neon"] .flashcard-face {
  box-shadow:
    0 0 30px rgba(224,64,192,0.06),
    0 0 60px rgba(64,192,255,0.03),
    inset 0 1px 0 rgba(255,255,255,0.03);
}
[data-theme="cyber-neon"] .flashcard::after {
  content:''; position:absolute; inset:-1px; border-radius:var(--radius-xl);
  background: linear-gradient(135deg, rgba(224,64,192,0.05), transparent 40%, rgba(64,192,255,0.04));
  pointer-events:none; z-index:1;
}

/* ===== Layout ===== */
#app {
  position:relative; z-index:1;
  width:100%;
  max-width: 780px;
  margin: 0 auto;
  padding: 0 10px;
  padding-bottom: env(safe-area-inset-bottom, 10px);
}

/* ===== Header ===== */
.header {
  display:flex; align-items:center; justify-content:space-between;
  padding:8px 0;
  position:sticky; top:0; z-index:100;
  background:var(--bg-primary);
  transition: background 0.3s ease;
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
}
[data-theme="dull-black"] .header { background:rgba(26,26,30,0.92); }
[data-theme="gleaming-pearl"] .header { background:rgba(9,9,15,0.94); }
[data-theme="dark-forest"] .header { background:rgba(12,17,12,0.93); }
[data-theme="white-pearl"] .header { background:rgba(244,242,238,0.94); border-bottom:1px solid rgba(0,0,0,0.04); }
[data-theme="dreamy"] .header { background:rgba(252,239,244,0.94); }
[data-theme="midnight-ocean"] .header { background:rgba(8,12,24,0.94); }
[data-theme="sakura"] .header { background:rgba(253,245,239,0.94); }
[data-theme="aurora"] .header { background:rgba(6,10,20,0.94); }
[data-theme="cyber-neon"] .header { background:rgba(8,8,26,0.94); }

.logo { display:flex; align-items:center; gap:8px; font-size:1.1rem; font-weight:700; letter-spacing:-0.02em; color:var(--text-primary); cursor:pointer; }
.logo-icon {
  width:30px; height:30px; display:flex; align-items:center; justify-content:center;
  border-radius:var(--radius-sm); background:var(--accent-glow); color:var(--accent); font-size:0.9rem;
}

/* Theme-specific logo icon styles */
[data-theme="gleaming-pearl"] .logo-icon {
  background: linear-gradient(135deg, rgba(120,104,224,0.2), rgba(160,100,220,0.15));
  box-shadow: 0 0 14px rgba(120,104,224,0.2);
}
[data-theme="dark-forest"] .logo-icon {
  background: rgba(232,134,42,0.15);
  color: var(--ember);
  box-shadow: 0 0 12px rgba(232,120,48,0.2);
}
[data-theme="white-pearl"] .logo-icon {
  background: linear-gradient(135deg, rgba(122,90,170,0.12), rgba(100,130,200,0.08));
  box-shadow: 0 2px 10px rgba(122,90,170,0.1);
}
[data-theme="dreamy"] .logo-icon {
  background: linear-gradient(135deg, rgba(224,122,170,0.15), rgba(200,160,240,0.1));
  box-shadow: 0 0 10px rgba(224,122,170,0.12);
}
[data-theme="midnight-ocean"] .logo-icon {
  background: linear-gradient(135deg, rgba(68,136,238,0.2), rgba(68,170,255,0.12));
  box-shadow: 0 0 12px rgba(68,136,238,0.18);
}
[data-theme="sakura"] .logo-icon {
  background: linear-gradient(135deg, rgba(232,112,90,0.15), rgba(240,160,140,0.1));
  box-shadow: 0 0 10px rgba(232,112,90,0.12);
}
[data-theme="aurora"] .logo-icon {
  background: linear-gradient(135deg, rgba(64,216,160,0.2), rgba(80,120,232,0.12));
  box-shadow: 0 0 14px rgba(64,216,160,0.2);
}
[data-theme="cyber-neon"] .logo-icon {
  background: linear-gradient(135deg, rgba(224,64,192,0.2), rgba(64,192,255,0.12));
  box-shadow: 0 0 14px rgba(224,64,192,0.25);
}

.header-actions { display:flex; align-items:center; gap:6px; }
.header-user { font-size:0.75rem; color:var(--text-secondary); max-width:100px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }

/* ===== Page title row ===== */
.page-title-row { display:flex; align-items:center; justify-content:space-between; gap:8px; margin-bottom:10px; }

/* ===== Buttons ===== */
.btn {
  display:inline-flex; align-items:center; justify-content:center; gap:7px;
  padding:9px 18px; border-radius:var(--radius-md); border:1px solid var(--border);
  background:var(--bg-tertiary); color:var(--text-primary);
  font-size:0.85rem; font-weight:500; cursor:pointer;
  transition:var(--transition); white-space:nowrap;
  -webkit-user-select:none; user-select:none; font-family:var(--font-main);
  position:relative; overflow:hidden;
}
.btn:active { transform:scale(0.97); }
.btn:hover { background:var(--bg-card-hover); border-color:var(--accent); }
.btn-primary { background:var(--accent); color:#fff; border-color:var(--accent); }
.btn-primary:hover { background:var(--accent-hover); }
.btn-sm { padding:6px 12px; font-size:0.78rem; border-radius:var(--radius-sm); }
.btn-lg { padding:12px 24px; font-size:0.95rem; border-radius:var(--radius-lg); }
.btn-icon { width:36px; height:36px; padding:0; border-radius:50%; font-size:0.92rem; }
.btn-icon-sm { width:28px; height:28px; padding:0; border-radius:50%; font-size:0.8rem; border:1px solid var(--border); background:var(--bg-tertiary); color:var(--text-primary); cursor:pointer; transition:var(--transition); display:inline-flex; align-items:center; justify-content:center; font-family:var(--font-main); }
.btn-ghost { background:transparent; border-color:transparent; }
.btn-ghost:hover { background:var(--bg-tertiary); }
.btn-danger { background:var(--danger-bg); color:var(--danger); border-color:var(--danger); }
.btn-danger:hover { background:var(--danger); color:#fff; }

/* ================================================================
   THEME-SPECIFIC BUTTON STYLES - Premium gradients & effects
   ================================================================ */

/* Dull Black: matte gradient buttons */
[data-theme="dull-black"] .btn-primary {
  background: linear-gradient(135deg, #6a6a8a, #7c7c9c, #7a7a9a);
}

/* Gleaming Pearl: iridescent pearl gradient */
[data-theme="gleaming-pearl"] .btn-primary {
  background: linear-gradient(135deg, #6050d0, #7868e0, #6858d8);
  border-color: #8878f0;
  text-shadow: 0 1px 3px rgba(0,0,0,0.4);
  box-shadow: 0 2px 16px rgba(120,104,224,0.25);
}
[data-theme="gleaming-pearl"] .deck-item:hover,
[data-theme="gleaming-pearl"] .card:hover {
  box-shadow: 0 0 30px rgba(120,104,224,0.08), 0 0 60px rgba(160,100,220,0.04);
  border-color: rgba(120,104,224,0.35);
}
[data-theme="gleaming-pearl"] .card {
  box-shadow: 0 0 30px rgba(120,104,224,0.03);
}

/* Dark Forest: ember glow buttons */
[data-theme="dark-forest"] .btn-primary {
  background: linear-gradient(135deg, #c86820, #e88630, #d87028);
  border-color: var(--ember);
  text-shadow: 0 1px 3px rgba(0,0,0,0.5);
  box-shadow: 0 2px 16px rgba(232,120,48,0.25);
}
[data-theme="dark-forest"] .deck-item:hover,
[data-theme="dark-forest"] .card:hover {
  box-shadow: 0 4px 24px rgba(232,120,48,0.08);
  border-color: rgba(232,134,42,0.3);
}
[data-theme="dark-forest"] .card {
  box-shadow: 0 4px 20px rgba(0,0,0,0.2);
}

/* White Pearl: refined violet gradient */
[data-theme="white-pearl"] .btn-primary {
  background: linear-gradient(135deg, #6a4a9a, #8a6aba, #7a5aaa);
  box-shadow: 0 2px 12px rgba(122,90,170,0.18);
}
[data-theme="white-pearl"] .deck-item:hover {
  box-shadow: 0 4px 20px rgba(0,0,0,0.06);
}
[data-theme="white-pearl"] .card {
  box-shadow: 0 2px 15px rgba(0,0,0,0.04);
}

/* Dreamy: soft pink gradient with glow */
[data-theme="dreamy"] .btn-primary {
  background: linear-gradient(135deg, #d068a0, #e88aba, #e07aaa);
  box-shadow: 0 2px 16px rgba(224,122,170,0.25);
  text-shadow: 0 1px 2px rgba(100,0,50,0.2);
}
[data-theme="dreamy"] .deck-item:hover {
  box-shadow: 0 4px 20px rgba(200,100,150,0.08);
  border-color: rgba(224,122,170,0.3);
}
[data-theme="dreamy"] .card {
  box-shadow: 0 2px 15px rgba(200,100,150,0.06);
}

/* Midnight Ocean: deep blue luminous gradient */
[data-theme="midnight-ocean"] .btn-primary {
  background: linear-gradient(135deg, #3070d0, #5598ff, #4488ee);
  box-shadow: 0 2px 18px rgba(68,136,238,0.3);
  text-shadow: 0 1px 3px rgba(0,0,40,0.5);
}
[data-theme="midnight-ocean"] .deck-item:hover {
  box-shadow: 0 4px 24px rgba(68,136,238,0.08);
  border-color: rgba(68,136,238,0.3);
}

/* Sakura: warm coral gradient */
[data-theme="sakura"] .btn-primary {
  background: linear-gradient(135deg, #d8604a, #f0806a, #e8705a);
  box-shadow: 0 2px 14px rgba(232,112,90,0.22);
  text-shadow: 0 1px 2px rgba(80,20,10,0.25);
}
[data-theme="sakura"] .deck-item:hover {
  box-shadow: 0 4px 20px rgba(232,112,90,0.08);
  border-color: rgba(232,112,90,0.25);
}

/* Aurora: teal-green gradient with northern glow */
[data-theme="aurora"] .btn-primary {
  background: linear-gradient(135deg, #28c088, #50e8b0, #40d8a0);
  color: #060a14;
  box-shadow: 0 2px 18px rgba(64,216,160,0.3);
  text-shadow: 0 1px 2px rgba(0,30,20,0.3);
}
[data-theme="aurora"] .deck-item:hover {
  box-shadow: 0 0 20px rgba(64,216,160,0.08), 0 0 40px rgba(80,120,232,0.04);
  border-color: rgba(64,216,160,0.3);
}
[data-theme="aurora"] .card {
  box-shadow: 0 0 20px rgba(64,216,160,0.04);
}

/* Cyber Neon: electric neon gradient */
[data-theme="cyber-neon"] .btn-primary {
  background: linear-gradient(135deg, #c030a0, #f050d0, #e040c0);
  color: #08081a;
  box-shadow: 0 0 18px rgba(224,64,192,0.35), 0 0 40px rgba(224,64,192,0.1);
  text-shadow: 0 0 6px rgba(255,100,220,0.3), 0 1px 2px rgba(0,0,0,0.3);
}
[data-theme="cyber-neon"] .deck-item:hover {
  box-shadow: 0 0 20px rgba(224,64,192,0.08), 0 0 40px rgba(64,192,255,0.04);
  border-color: rgba(224,64,192,0.3);
}
[data-theme="cyber-neon"] .card {
  box-shadow: 0 0 20px rgba(224,64,192,0.04);
}

/* ===== Input ===== */
.input,.textarea,.select {
  width:100%; padding:10px 14px; border-radius:var(--radius-md); border:1px solid var(--border);
  background:var(--bg-input); color:var(--text-primary); font-size:0.9rem; font-family:var(--font-main);
  transition:var(--transition); outline:none;
}
.input:focus,.textarea:focus { border-color:var(--accent); box-shadow:0 0 0 3px var(--accent-glow); }
.textarea { min-height:80px; resize:vertical; }
.input-group { display:flex; flex-direction:column; gap:4px; margin-bottom:10px; }
.input-label { font-size:0.78rem; font-weight:600; color:var(--text-secondary); text-transform:uppercase; letter-spacing:0.05em; }

/* Password toggle */
.pw-wrap { position:relative; }
.pw-wrap .input { padding-right:44px; }
.pw-toggle {
  position:absolute; right:8px; top:50%; transform:translateY(-50%);
  width:32px; height:32px; border:none; background:transparent;
  color:var(--text-tertiary); cursor:pointer; border-radius:50%;
  display:flex; align-items:center; justify-content:center;
  font-size:0.85rem; transition:var(--transition-fast);
}
.pw-toggle:hover { color:var(--text-primary); background:var(--bg-tertiary); }

/* ===== Card ===== */
.card {
  background:var(--bg-card); border:1px solid var(--border); border-radius:var(--radius-lg); padding:14px;
  transition: background 0.25s ease, border-color 0.25s ease, box-shadow 0.25s ease;
}

/* ===== Flashcard ===== */
.flashcard-area { perspective:1200px; flex:1; display:flex; flex-direction:column; margin:2px 0; }
.flashcard {
  width:100%; flex:1; min-height:220px; position:relative; cursor:pointer;
  transition:transform 0.5s cubic-bezier(0.4,0,0.2,1);
  transform-style:preserve-3d; border-radius:var(--radius-xl);
  -webkit-user-select:none; user-select:none;
  will-change: transform;
}
.flashcard.flipped { transform:rotateY(180deg); }
.flashcard-face {
  position:absolute; inset:0; backface-visibility:hidden; -webkit-backface-visibility:hidden;
  border-radius:var(--radius-xl);
  display:flex; flex-direction:column; align-items:center; justify-content:center;
  padding:20px 16px;
  border:1.5px solid var(--border); overflow:hidden;
}
.flashcard-front { background:var(--card-front); }
.flashcard-back { background:var(--card-back); transform:rotateY(180deg); }

.fc-number { font-size:0.72rem; color:var(--text-tertiary); margin-bottom:4px; font-weight:700; letter-spacing:0.1em; }
.fc-word { font-size:2.2rem; font-weight:700; text-align:center; color:var(--text-primary); line-height:1.3; letter-spacing:-0.01em; }
.fc-meaning-lg {
  font-size:2.4rem; font-weight:800; text-align:center; color:var(--text-primary);
  margin-bottom:10px; line-height:1.25; letter-spacing:-0.01em;
}
.fc-example { font-size:0.92rem; color:var(--text-secondary); text-align:center; line-height:1.6; max-width:94%; }
.fc-example-jp { font-size:0.84rem; color:var(--text-tertiary); text-align:center; margin-top:5px; }
.fc-emoji { font-size:2.4rem; margin-top:8px; }
.fc-tap-hint { position:absolute; bottom:10px; font-size:0.65rem; color:var(--text-tertiary); letter-spacing:0.06em; opacity:0.6; }

/* ===== Study View Layout ===== */
.study-view {
  display:flex; flex-direction:column;
  height:calc(100dvh - 56px);
  padding-bottom:4px;
  overflow:hidden;
}
.study-top-bar { display:flex; align-items:center; justify-content:space-between; gap:6px; margin-bottom:2px; flex-shrink:0; }
.study-counter { font-size:0.75rem; color:var(--text-tertiary); font-weight:600; }
.study-controls { flex-shrink:0; padding-bottom:4px; }

.study-bottom-controls {
  display:flex; gap:8px; align-items:center; justify-content:center; margin-top:6px;
}

.mode-indicator {
  text-align:center; padding:4px 10px;
  background:var(--bg-tertiary); border-radius:var(--radius-sm);
  font-size:0.7rem; font-weight:600; color:var(--accent);
  letter-spacing:0.04em; border:1px solid var(--border);
}
[data-theme="dark-forest"] .mode-indicator { color:var(--ember); }

.progress-bar-container { width:100%; height:3px; background:var(--bg-tertiary); border-radius:2px; overflow:hidden; margin:3px 0; }
.progress-bar-fill { height:100%; background:var(--accent); border-radius:2px; transition:width 0.4s ease; }
[data-theme="dark-forest"] .progress-bar-fill { background:var(--ember); }

/* =====================================================
   RATING BUTTONS SYSTEM - 3 Layout Options
   ===================================================== */

.rating-area-wrap { margin-top:6px; }
.rating-area-wrap.layout-right { display:flex; justify-content:flex-end; }
.rating-area-wrap.layout-bottom { display:flex; justify-content:center; }
.rating-area-wrap.layout-left { display:flex; justify-content:flex-start; }

.rating-grid-2x2 { display:grid; grid-template-columns:1fr 1fr; gap:8px; }
.layout-right .rating-grid-2x2,
.layout-left .rating-grid-2x2 { width:min(320px, 55%); }
.layout-bottom .rating-grid-2x2 { width:100%; max-width:600px; }

.rating-btn {
  display:flex; flex-direction:column; align-items:center; justify-content:center; gap:3px;
  padding:16px 8px; border-radius:var(--radius-md);
  border:2.5px solid var(--border); background:var(--bg-card);
  color:var(--text-primary); cursor:pointer;
  transition: transform 0.12s ease, background 0.2s ease, border-color 0.2s ease;
  font-family:var(--font-main);
  min-height:72px;
  position:relative; overflow:hidden;
}
.layout-right .rating-btn,
.layout-left .rating-btn { aspect-ratio:1; }
.layout-bottom .rating-btn { aspect-ratio:auto; min-height:68px; }

.rating-btn:active { transform:scale(0.93); }
.rating-icon { font-size:1.7rem; }
.rating-label { font-size:0.82rem; font-weight:700; line-height:1.2; }
.rating-hint { display:block; font-size:0.6rem; color:var(--text-tertiary); font-weight:400; margin-top:1px; opacity:0.7; }

.rating-btn-mastered { border-color:var(--success); background:var(--success-bg); }
.rating-btn-mastered:hover,.rating-btn-mastered:active { background:var(--success); color:#fff; }
.rating-btn-good { border-color:var(--info); background:var(--info-bg); }
.rating-btn-good:hover,.rating-btn-good:active { background:var(--info); color:#fff; }
.rating-btn-unsure { border-color:var(--warning); background:var(--warning-bg); }
.rating-btn-unsure:hover,.rating-btn-unsure:active { background:var(--warning); color:#fff; }
.rating-btn-forgot { border-color:var(--danger); background:var(--danger-bg); }
.rating-btn-forgot:hover,.rating-btn-forgot:active { background:var(--danger); color:#fff; }

/* === Simple Mode O/X === */
.simple-btns { display:grid; grid-template-columns:1fr 1fr; gap:10px; }
.layout-right .simple-btns,
.layout-left .simple-btns { width:min(300px, 55%); }
.layout-bottom .simple-btns { width:100%; max-width:600px; }

.simple-btn {
  display:flex; align-items:center; justify-content:center;
  border-radius:var(--radius-lg);
  font-size:2.6rem; cursor:pointer;
  transition: transform 0.12s ease, background 0.2s ease, opacity 0.2s ease;
  border:2.5px solid transparent;
  background:transparent; font-family:var(--font-main);
  -webkit-user-select:none; user-select:none;
  padding:20px 10px;
  min-height:72px;
  position:relative; overflow:hidden;
}
.layout-right .simple-btn,
.layout-left .simple-btn { aspect-ratio:1.2; }
.layout-bottom .simple-btn { aspect-ratio:auto; }

.simple-btn:active { transform:scale(0.92); }
.simple-correct { border-color:var(--success); background:var(--success-bg); }
.simple-correct:active { background:var(--success); }
.simple-wrong { border-color:var(--danger); background:var(--danger-bg); }
.simple-wrong:active { background:var(--danger); }

.simple-preflip .simple-btn { opacity:0.5; }
.simple-preflip .simple-btn:hover { opacity:0.8; }
.simple-postflip .simple-btn { opacity:1; }

.simple-hint-text {
  font-size:0.6rem; color:var(--text-tertiary); text-align:right;
  margin-top:2px; opacity:0.5; grid-column:1/3;
}
.layout-bottom .simple-hint-text { text-align:center; }
.layout-left .simple-hint-text { text-align:left; }

/* ===== Oni Mode ===== */
.oni-input-area { display:flex; gap:8px; margin-top:8px; }
.oni-input {
  flex:1; padding:12px 16px; border-radius:var(--radius-md);
  border:2px solid var(--border); background:var(--bg-input);
  color:var(--text-primary); font-size:1.05rem; font-family:var(--font-main);
  outline:none; transition:var(--transition);
}
.oni-input:focus { border-color:var(--accent); }
.oni-input.correct { border-color:var(--success); background:var(--success-bg); }
.oni-input.wrong { border-color:var(--danger); background:var(--danger-bg); }

/* ===== Deck List ===== */
.deck-list { display:flex; flex-direction:column; gap:6px; }
.deck-item {
  display:flex; align-items:center;
  padding:12px 14px; background:var(--bg-card);
  border:1px solid var(--border); border-radius:var(--radius-lg);
  cursor:pointer; transition: background 0.2s ease, border-color 0.2s ease, box-shadow 0.3s ease; gap:10px;
}
.deck-item:hover { border-color:var(--accent); background:var(--bg-card-hover); }
.deck-item:active { transform:scale(0.99); }
.deck-icon {
  width:38px; height:38px; display:flex; align-items:center; justify-content:center;
  border-radius:var(--radius-md); background:var(--accent-glow);
  color:var(--accent); font-size:0.95rem; flex-shrink:0;
}
[data-theme="dark-forest"] .deck-icon { background:rgba(232,134,42,0.12); color:var(--ember); }
.deck-info { flex:1; min-width:0; }
.deck-name { font-weight:600; font-size:0.9rem; color:var(--text-primary); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.deck-meta { font-size:0.72rem; color:var(--text-tertiary); margin-top:2px; }
.deck-actions { display:flex; gap:4px; flex-shrink:0; }

/* ===== Study Mode Select ===== */
.study-mode-card { display:flex; align-items:center; gap:14px; cursor:pointer; text-align:left; padding:14px 16px; }
.study-mode-card:hover { border-color:var(--accent); }
.study-mode-icon { width:44px; height:44px; border-radius:var(--radius-md); display:flex; align-items:center; justify-content:center; font-size:1.2rem; flex-shrink:0; }
.study-mode-info { flex:1; }
.study-mode-name { font-weight:700; font-size:0.95rem; margin-bottom:2px; }
.study-mode-desc { font-size:0.78rem; color:var(--text-secondary); }

/* ===== SRS Explanation ===== */
.srs-explain-card {
  margin-top:14px; padding:14px;
  background:var(--bg-card); border:1px solid var(--border);
  border-radius:var(--radius-lg);
}
.srs-explain-title { font-weight:700; font-size:0.88rem; margin-bottom:6px; display:flex; align-items:center; gap:8px; color:var(--accent); }
[data-theme="dark-forest"] .srs-explain-title { color:var(--ember); }
.srs-explain-text { font-size:0.8rem; color:var(--text-secondary); line-height:1.7; }
.srs-detail-grid { display:grid; grid-template-columns:1fr 1fr; gap:6px; margin-top:8px; }
.srs-detail-item { padding:8px 10px; background:var(--bg-tertiary); border-radius:var(--radius-sm); border:1px solid var(--border-light); }
.srs-detail-item .srs-label { font-size:0.72rem; font-weight:700; }
.srs-detail-item .srs-desc { font-size:0.65rem; color:var(--text-tertiary); margin-top:1px; }

/* ===== Menu Panel (RIGHT side) ===== */
.menu-overlay { position:fixed; inset:0; background:var(--bg-overlay); z-index:999; animation:fadeIn 0.15s ease; }
.menu-panel {
  position:fixed; top:0; right:0;
  width:280px; max-width:80vw; height:100%;
  background:var(--menu-bg);
  border-left:1px solid var(--border);
  z-index:1000; overflow-y:auto;
  animation:slideFromRight 0.25s cubic-bezier(0.4,0,0.2,1);
  padding: env(safe-area-inset-top, 14px) 0 env(safe-area-inset-bottom, 14px);
}
.menu-header { padding:16px; border-bottom:1px solid var(--border); }
.menu-user { display:flex; align-items:center; gap:12px; }
.menu-avatar {
  width:38px; height:38px; border-radius:50%;
  background:var(--accent-glow); display:flex; align-items:center; justify-content:center;
  color:var(--accent); font-weight:700; font-size:0.95rem;
}
.menu-item {
  display:flex; align-items:center; gap:12px;
  padding:12px 16px; color:var(--text-primary);
  font-size:0.88rem; font-weight:500; cursor:pointer;
  transition:var(--transition-fast);
  border:none; background:none; width:100%; text-align:left; font-family:var(--font-main);
}
.menu-item:hover { background:var(--bg-tertiary); }
.menu-item i { width:20px; text-align:center; color:var(--text-secondary); }
.menu-divider { height:1px; background:var(--border); margin:4px 0; }

/* ===== Modal ===== */
.modal-overlay {
  position:fixed; inset:0; background:var(--bg-overlay); z-index:1000;
  display:flex; align-items:flex-end; justify-content:center;
  animation:fadeIn 0.15s ease;
}
@media(min-width:768px) { .modal-overlay { align-items:center; padding:20px; } }
.modal-content {
  width:100%; max-width:500px; max-height:88vh;
  background:var(--bg-secondary);
  border-radius:var(--radius-xl) var(--radius-xl) 0 0;
  overflow-y:auto; animation:slideUp 0.25s cubic-bezier(0.4,0,0.2,1);
}
@media(min-width:768px) { .modal-content { border-radius:var(--radius-xl); } }
.modal-header { display:flex; align-items:center; justify-content:space-between; padding:14px 18px; border-bottom:1px solid var(--border); position:sticky; top:0; background:var(--bg-secondary); z-index:10; }
.modal-title { font-size:1rem; font-weight:700; }
.modal-body { padding:16px; }
.modal-footer { padding:12px 18px; border-top:1px solid var(--border); display:flex; gap:8px; justify-content:flex-end; }

/* ===== Stats ===== */
.stats-grid { display:grid; grid-template-columns:repeat(2,1fr); gap:8px; margin-bottom:12px; }
.stat-card { padding:12px; background:var(--bg-card); border:1px solid var(--border); border-radius:var(--radius-lg); text-align:center; }
.stat-value { font-size:1.5rem; font-weight:800; color:var(--text-primary); line-height:1.2; }
.stat-label { font-size:0.68rem; color:var(--text-tertiary); text-transform:uppercase; letter-spacing:0.08em; margin-top:2px; font-weight:600; }

.streak-display { text-align:center; padding:16px; background:var(--bg-card); border:1px solid var(--border); border-radius:var(--radius-xl); margin-bottom:12px; position:relative; overflow:hidden; }
.streak-number { font-size:2.8rem; font-weight:900; color:var(--accent); line-height:1; }
[data-theme="dark-forest"] .streak-number { color:var(--ember); }
[data-theme="midnight-ocean"] .streak-number { color:#5598ff; }
[data-theme="aurora"] .streak-number { color:#50e8b0; }
[data-theme="cyber-neon"] .streak-number { color:#ff60e0; text-shadow:0 0 12px rgba(255,96,224,0.3); }
.streak-label { font-size:0.82rem; color:var(--text-secondary); margin-top:4px; }
.streak-badge { font-size:1.8rem; display:inline-block; }
@keyframes sparkle { 0%,100%{opacity:1;transform:scale(1);} 50%{opacity:0.6;transform:scale(1.15);} }
.streak-sparkle { animation:sparkle 2s ease-in-out infinite; }

/* ================================================================
   BLADE FLASH EFFECT
   A sharp, knife-edge light sweep from right to left.
   Only active on: gleaming-pearl, cyber-neon
   Uses ::after pseudo-element for the blade overlay.
   ================================================================ */

/* The blade flash keyframe: a thin, bright band sweeps right to left */
@keyframes bladeFlash {
  0% {
    transform: translateX(100%) skewX(-15deg);
    opacity: 0;
  }
  10% {
    opacity: 1;
  }
  90% {
    opacity: 1;
  }
  100% {
    transform: translateX(-100%) skewX(-15deg);
    opacity: 0;
  }
}

/* Base flash class - thin blade of light */
.blade-flash::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 35%;
  height: 100%;
  background: linear-gradient(
    90deg,
    transparent 0%,
    rgba(255,255,255,0.01) 20%,
    rgba(255,255,255,0.12) 45%,
    rgba(255,255,255,0.25) 50%,
    rgba(255,255,255,0.12) 55%,
    rgba(255,255,255,0.01) 80%,
    transparent 100%
  );
  transform: translateX(100%) skewX(-15deg);
  animation: bladeFlash 0.35s cubic-bezier(0.25, 0.1, 0.25, 1) forwards;
  pointer-events: none;
  z-index: 10;
  border-radius: inherit;
}

/* Gleaming Pearl flash: violet-blue tinted blade */
[data-theme="gleaming-pearl"] .blade-flash::after {
  background: linear-gradient(
    90deg,
    transparent 0%,
    rgba(160,140,255,0.01) 20%,
    rgba(160,140,255,0.18) 45%,
    rgba(200,180,255,0.35) 50%,
    rgba(160,140,255,0.18) 55%,
    rgba(160,140,255,0.01) 80%,
    transparent 100%
  );
}

/* Cyber Neon flash: magenta-cyan tinted blade */
[data-theme="cyber-neon"] .blade-flash::after {
  background: linear-gradient(
    90deg,
    transparent 0%,
    rgba(224,64,192,0.01) 15%,
    rgba(224,100,220,0.2) 40%,
    rgba(255,150,240,0.4) 50%,
    rgba(100,200,255,0.2) 60%,
    rgba(64,192,255,0.01) 85%,
    transparent 100%
  );
}

/* ================================================================
   THEME SIGNATURE DECORATIVE ELEMENTS
   Unique visual identity bars and accents
   ================================================================ */

/* Aurora: northern lights bar at top */
[data-theme="aurora"] body::after {
  content: '';
  position: fixed;
  top: 0; left: 0; right: 0; height: 3px;
  background: linear-gradient(90deg, #40d8a0, #5080e8, #a050e8, #40d8a0);
  background-size: 200% 100%;
  animation: auroraBar 6s linear infinite;
  z-index: 9999;
  pointer-events: none;
}
@keyframes auroraBar {
  0% { background-position: 0% 0; }
  100% { background-position: 200% 0; }
}

/* Aurora: constant subtle glow on buttons */
[data-theme="aurora"] .btn:not(.btn-ghost):not(.btn-icon):not(.btn-icon-sm),
[data-theme="aurora"] .rating-btn,
[data-theme="aurora"] .simple-btn {
  box-shadow: 0 0 6px rgba(64,216,160,0.15), 0 0 14px rgba(64,216,160,0.06);
}
[data-theme="aurora"] .btn:not(.btn-ghost):not(.btn-icon):not(.btn-icon-sm):hover,
[data-theme="aurora"] .rating-btn:hover,
[data-theme="aurora"] .simple-btn:hover {
  box-shadow: 0 0 10px rgba(64,216,160,0.25), 0 0 22px rgba(80,120,232,0.1);
}
[data-theme="aurora"] .btn-primary {
  box-shadow: 0 0 12px rgba(64,216,160,0.35), 0 0 28px rgba(64,216,160,0.12);
}

/* Cyber Neon: constant neon glow on buttons */
[data-theme="cyber-neon"] .btn:not(.btn-ghost):not(.btn-icon):not(.btn-icon-sm),
[data-theme="cyber-neon"] .rating-btn,
[data-theme="cyber-neon"] .simple-btn {
  box-shadow: 0 0 6px rgba(224,64,192,0.15), 0 0 14px rgba(64,192,255,0.06);
}
[data-theme="cyber-neon"] .btn:not(.btn-ghost):not(.btn-icon):not(.btn-icon-sm):hover,
[data-theme="cyber-neon"] .rating-btn:hover,
[data-theme="cyber-neon"] .simple-btn:hover {
  box-shadow: 0 0 10px rgba(224,64,192,0.3), 0 0 22px rgba(64,192,255,0.12);
}
[data-theme="cyber-neon"] .btn-primary {
  box-shadow: 0 0 14px rgba(224,64,192,0.4), 0 0 30px rgba(224,64,192,0.15);
}

/* Cyber Neon: neon bar at bottom */
[data-theme="cyber-neon"] body::after {
  content: '';
  position: fixed;
  bottom: 0; left: 0; right: 0; height: 2px;
  background: linear-gradient(90deg, #e040c0, #40c0ff, #e040c0);
  background-size: 200% 100%;
  animation: neonBar 3s linear infinite;
  z-index: 9999;
  pointer-events: none;
}
@keyframes neonBar {
  0% { background-position: 0% 0; }
  100% { background-position: 200% 0; }
}

/* Dark Forest: warm ember bar at bottom */
[data-theme="dark-forest"] .header::after {
  content: '';
  position: absolute;
  bottom: -1px; left: 10%; right: 10%; height: 1px;
  background: linear-gradient(90deg, transparent, rgba(232,120,48,0.3), transparent);
  pointer-events: none;
}

/* Midnight Ocean: subtle wave line */
[data-theme="midnight-ocean"] .header::after {
  content: '';
  position: absolute;
  bottom: -1px; left: 10%; right: 10%; height: 1px;
  background: linear-gradient(90deg, transparent, rgba(68,136,238,0.2), transparent);
  pointer-events: none;
}

/* Sakura: delicate petal-pink border */
[data-theme="sakura"] .header::after {
  content: '';
  position: absolute;
  bottom: -1px; left: 15%; right: 15%; height: 1px;
  background: linear-gradient(90deg, transparent, rgba(232,112,90,0.2), transparent);
  pointer-events: none;
}

/* Dreamy: soft pastel underline */
[data-theme="dreamy"] .header::after {
  content: '';
  position: absolute;
  bottom: -1px; left: 15%; right: 15%; height: 1px;
  background: linear-gradient(90deg, transparent, rgba(224,122,170,0.2), transparent);
  pointer-events: none;
}

/* Gleaming Pearl: subtle pearl sheen line */
[data-theme="gleaming-pearl"] .header::after {
  content: '';
  position: absolute;
  bottom: -1px; left: 5%; right: 5%; height: 1px;
  background: linear-gradient(90deg, transparent, rgba(120,104,224,0.25), rgba(160,120,255,0.15), transparent);
  pointer-events: none;
}

.weekly-chart { display:flex; align-items:flex-end; gap:6px; height:90px; padding:12px; background:var(--bg-card); border:1px solid var(--border); border-radius:var(--radius-lg); margin-bottom:12px; }
.chart-bar-wrapper { flex:1; display:flex; flex-direction:column; align-items:center; gap:3px; height:100%; justify-content:flex-end; }
.chart-bar { width:100%; max-width:30px; background:var(--accent); border-radius:3px 3px 0 0; min-height:2px; transition:height 0.5s ease; }
[data-theme="dark-forest"] .chart-bar { background:var(--ember); }

.distribution-bars { margin-bottom:12px; }
.dist-row { display:flex; align-items:center; gap:8px; margin-bottom:5px; }
.dist-label { width:72px; font-size:0.75rem; font-weight:600; color:var(--text-secondary); text-align:right; }
.dist-bar-track { flex:1; height:8px; background:var(--bg-tertiary); border-radius:4px; overflow:hidden; }
.dist-bar-fill { height:100%; border-radius:4px; transition:width 0.5s ease; }
.dist-count { width:32px; font-size:0.75rem; color:var(--text-tertiary); font-weight:600; }

/* ===== History ===== */
.history-item {
  display:flex; align-items:center; gap:10px;
  padding:10px 14px; background:var(--bg-card);
  border:1px solid var(--border); border-radius:var(--radius-lg);
  cursor:pointer; transition: background 0.2s ease, border-color 0.2s ease;
}
.history-item:hover { border-color:var(--accent); background:var(--bg-card-hover); }
.history-icon {
  width:36px; height:36px; display:flex; align-items:center; justify-content:center;
  border-radius:var(--radius-sm); background:var(--accent-glow);
  color:var(--accent); font-size:0.85rem; flex-shrink:0;
}
.history-info { flex:1; min-width:0; }
.history-name { font-weight:600; font-size:0.85rem; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.history-meta { font-size:0.68rem; color:var(--text-tertiary); margin-top:1px; }

/* ===== Theme Selector ===== */
.theme-grid { display:grid; grid-template-columns:repeat(3,1fr); gap:6px; margin:10px 0; }
.theme-option { display:flex; flex-direction:column; align-items:center; gap:5px; padding:10px 4px; border-radius:var(--radius-md); border:2px solid var(--border); cursor:pointer; transition:var(--transition); background:var(--bg-card); }
.theme-option:hover { border-color:var(--accent); }
.theme-option.active { border-color:var(--accent); box-shadow:0 0 0 2px var(--accent-glow); }
.theme-preview { width:28px; height:28px; border-radius:50%; border:2px solid rgba(128,128,128,0.3); }
.theme-preview-dull { background:linear-gradient(135deg,#1a1a1e,#2c2c31); }
.theme-preview-pearl { background:linear-gradient(135deg,#09090f,#28283c); }
.theme-preview-forest { background:linear-gradient(135deg,#0c110c,#283024); }
.theme-preview-white { background:linear-gradient(135deg,#f4f2ee,#fefefe); }
.theme-preview-dreamy { background:linear-gradient(135deg,#fceff4,#fff4f8); }
.theme-preview-ocean { background:linear-gradient(135deg,#080c18,#1c2848); }
.theme-preview-sakura { background:linear-gradient(135deg,#fdf5ef,#eedad0); }
.theme-preview-aurora { background:linear-gradient(135deg,#060a14,#40d8a0); }
.theme-preview-cyber { background:linear-gradient(135deg,#08081a,#e040c0); }
.theme-label { font-size:0.55rem; font-weight:600; color:var(--text-secondary); text-align:center; line-height:1.2; }

/* ===== Layout Option Selector ===== */
.layout-grid { display:grid; grid-template-columns:repeat(3,1fr); gap:6px; margin:10px 0; }
.layout-option {
  display:flex; flex-direction:column; align-items:center; gap:6px;
  padding:12px 6px; border-radius:var(--radius-md);
  border:2px solid var(--border); cursor:pointer;
  transition:var(--transition); background:var(--bg-card);
}
.layout-option:hover { border-color:var(--accent); }
.layout-option.active { border-color:var(--accent); box-shadow:0 0 0 2px var(--accent-glow); }
.layout-icon { font-size:1.4rem; }
.layout-label { font-size:0.6rem; font-weight:600; color:var(--text-secondary); text-align:center; line-height:1.2; }

/* ===== Search ===== */
.search-bar { display:flex; gap:8px; margin-bottom:10px; }
.search-wrapper { flex:1; position:relative; }
.search-input { width:100%; padding:10px 14px 10px 38px; border-radius:var(--radius-lg); border:1px solid var(--border); background:var(--bg-input); color:var(--text-primary); font-size:0.9rem; font-family:var(--font-main); outline:none; transition:var(--transition); }
.search-input:focus { border-color:var(--accent); }
.search-wrapper i { position:absolute; left:13px; top:50%; transform:translateY(-50%); color:var(--text-tertiary); font-size:0.85rem; }

/* ===== Tabs ===== */
.tabs { display:flex; gap:3px; background:var(--bg-tertiary); padding:3px; border-radius:var(--radius-md); margin-bottom:12px; }
.tab { flex:1; padding:8px 12px; border-radius:var(--radius-sm); border:none; background:transparent; color:var(--text-secondary); font-size:0.8rem; font-weight:600; cursor:pointer; transition:var(--transition-fast); font-family:var(--font-main); text-align:center; }
.tab.active { background:var(--bg-card); color:var(--text-primary); box-shadow:var(--shadow-sm); }

/* ===== Section Title ===== */
.section-title { font-size:0.95rem; font-weight:700; margin-bottom:8px; color:var(--text-primary); }

/* ===== Empty State ===== */
.empty-state { text-align:center; padding:30px 16px; color:var(--text-tertiary); }
.empty-icon { font-size:2.5rem; margin-bottom:8px; opacity:0.5; }
.empty-text { font-size:0.9rem; font-weight:500; }

/* ===== Badge ===== */
.badge { display:inline-flex; align-items:center; padding:3px 9px; border-radius:20px; font-size:0.68rem; font-weight:700; }
.badge-accent { background:var(--accent-glow); color:var(--accent); }
.badge-success { background:var(--success-bg); color:var(--success); }
.badge-warning { background:var(--warning-bg); color:var(--warning); }

/* ===== Toast ===== */
.toast-container { position:fixed; top:14px; left:50%; transform:translateX(-50%); z-index:10000; display:flex; flex-direction:column; gap:6px; width:88%; max-width:380px; }
.toast { padding:10px 14px; border-radius:var(--radius-md); background:var(--bg-card); border:1px solid var(--border); color:var(--text-primary); font-size:0.85rem; font-weight:500; box-shadow:var(--shadow-lg); animation:slideDown 0.25s ease; display:flex; align-items:center; gap:8px; }
.toast-success { border-left:3px solid var(--success); }
.toast-error { border-left:3px solid var(--danger); }
.toast-info { border-left:3px solid var(--info); }

/* ===== Card List ===== */
.card-list-item { display:flex; align-items:center; padding:9px 12px; border-bottom:1px solid var(--border-light); gap:8px; }
.card-list-item:last-child { border-bottom:none; }
.card-list-number { width:24px; height:24px; display:flex; align-items:center; justify-content:center; background:var(--bg-tertiary); border-radius:50%; font-size:0.65rem; font-weight:700; color:var(--text-tertiary); flex-shrink:0; }
.card-list-word { font-weight:600; font-size:0.88rem; color:var(--text-primary); min-width:70px; }
.card-list-meaning { flex:1; font-size:0.8rem; color:var(--text-secondary); overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
.card-list-status { width:7px; height:7px; border-radius:50%; flex-shrink:0; }
.status-mastered { background:var(--success); }
.status-good { background:var(--info); }
.status-unsure { background:var(--warning); }
.status-forgot { background:var(--danger); }
.status-unseen { background:var(--text-tertiary); opacity:0.3; }

/* ===== Loading ===== */
.loading { display:flex; align-items:center; justify-content:center; padding:30px; }
.spinner { width:28px; height:28px; border:3px solid var(--border); border-top-color:var(--accent); border-radius:50%; animation:spin 0.8s linear infinite; }

/* ===== File Drop ===== */
.file-drop-zone { border:2px dashed var(--border); border-radius:var(--radius-lg); padding:24px; text-align:center; cursor:pointer; transition:var(--transition); background:var(--bg-input); }
.file-drop-zone:hover { border-color:var(--accent); background:var(--accent-glow); }
.file-drop-zone i { font-size:1.8rem; color:var(--text-tertiary); margin-bottom:6px; }
.file-drop-text { font-size:0.85rem; color:var(--text-secondary); }
.file-drop-sub { font-size:0.72rem; color:var(--text-tertiary); margin-top:3px; }
.file-input-hidden { position:absolute; width:0; height:0; opacity:0; overflow:hidden; }

/* ===== Animations ===== */
@keyframes fadeIn { from{opacity:0;} to{opacity:1;} }
@keyframes slideUp { from{transform:translateY(100%);} to{transform:translateY(0);} }
@keyframes slideFromRight { from{transform:translateX(100%);} to{transform:translateX(0);} }
@keyframes slideDown { from{transform:translateY(-20px);opacity:0;} to{transform:translateY(0);opacity:1;} }
@keyframes spin { to{transform:rotate(360deg);} }
.fade-in { animation:fadeIn 0.2s ease; }

/* ===== Responsive ===== */
@media(max-width:380px) {
  .fc-word { font-size:1.7rem; }
  .fc-meaning-lg { font-size:1.8rem; }
  .rating-label { font-size:0.72rem; }
  .rating-icon { font-size:1.4rem; }
  .simple-btn { font-size:2.2rem; }
  .layout-right .rating-grid-2x2,
  .layout-left .rating-grid-2x2 { width:min(260px, 65%); }
  .layout-right .simple-btns,
  .layout-left .simple-btns { width:min(240px, 65%); }
  .theme-grid { grid-template-columns:repeat(3,1fr); }
}
@media(min-width:768px) {
  #app { padding:0 16px; }
  .flashcard { min-height:300px; }
  .fc-meaning-lg { font-size:2.6rem; }
  .fc-word { font-size:2.4rem; }
  .stats-grid { grid-template-columns:repeat(4,1fr); }
  .layout-right .rating-grid-2x2,
  .layout-left .rating-grid-2x2 { width:min(300px, 45%); gap:10px; }
  .layout-right .simple-btns,
  .layout-left .simple-btns { width:min(280px, 45%); }
  .simple-btn { font-size:3rem; }
  .rating-icon { font-size:2rem; }
  .rating-btn { min-height:80px; }
}
@media(min-width:1024px) {
  #app { max-width:860px; }
}
@supports(padding-top:env(safe-area-inset-top)) {
  .header { padding-top:max(8px, env(safe-area-inset-top)); }
}
